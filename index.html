<html><head><base href="index.html">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–≠–∫–æ-–°–∞–¥ –ö–ª–∏–∫–µ—Ä</title>
<style>
body {
    font-family: 'Comfortaa', cursive;
    background: linear-gradient(135deg, #7cbb5e, #2e8b57);
    color: #1a3a1a;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
    overflow-x: hidden;
}
.game-container {
    background: rgba(255, 255, 255, 0.8);
    border-radius: 20px;
    padding: 30px;
    text-align: center;
    box-shadow: 0 0 20px rgba(0, 100, 0, 0.3);
    max-width: 800px;
    width: 90%;
}
#garden {
    width: 200px;
    height: 200px;
    cursor: pointer;
    transition: transform 0.3s;
    margin: 20px auto;
}
#garden:hover {
    transform: scale(1.05);
}
#garden:active {
    transform: scale(0.95);
}
.upgrade, .special-action {
    margin: 10px;
    padding: 10px;
    background: rgba(124, 187, 94, 0.3);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    display: inline-block;
}
.upgrade:hover, .special-action:hover {
    background: rgba(124, 187, 94, 0.5);
    transform: translateY(-3px);
}
.upgrade:active, .special-action:active {
    transform: translateY(1px);
}
#particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
}
@keyframes grow {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
}
.grow {
    animation: grow 0.5s;
}
#message-display {
    font-size: 18px;
    margin: 20px 0;
    min-height: 30px;
    color: #4a7023;
}
.special-actions {
    display: flex;
    justify-content: space-around;
    margin-top: 20px;
}
#weather-event {
    position: fixed;
    top: 10px;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(135, 206, 250, 0.8);
    padding: 10px 20px;
    border-radius: 20px;
    display: none;
}
.menu {
    position: fixed;
    top: 0;
    left: -300px;
    width: 300px;
    height: 100%;
    background: rgba(255, 255, 255, 0.9);
    transition: left 0.3s ease-in-out;
    overflow-y: auto;
    padding: 20px;
    box-sizing: border-box;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
}
.menu.open {
    left: 0;
}
.menu-toggle {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 1000;
    background: rgba(124, 187, 94, 0.8);
    border: none;
    color: white;
    padding: 10px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
}
.menu-toggle:hover {
    background: rgba(124, 187, 94, 1);
}
.menu-item {
    margin: 15px 0;
    padding: 12px;
    background: rgba(124, 187, 94, 0.3);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.3s;
    text-align: left;
    font-size: 16px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}
.menu-item:hover {
    background: rgba(124, 187, 94, 0.5);
    transform: translateY(-3px);
}
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}
.pulse {
    animation: pulse 2s infinite;
}
.help-button {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background: rgba(124, 187, 94, 0.8);
    border: none;
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 16px;
}
.help-button:hover {
    background: rgba(124, 187, 94, 1);
}
.modal {
    display: none;
    position: fixed;
    z-index: 1001;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
}
.modal-content {
    background-color: #fefefe;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 600px;
    border-radius: 10px;
}
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
}
.close:hover,
.close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
}
#passive-income {
    font-size: 18px;
    margin-top: 20px;
    color: #4a7023;
}
.modal-buttons {
    display: flex;
    justify-content: space-around;
    margin-top: 20px;
}
.modal-button {
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    transition: all 0.3s;
}
.modal-button.yes {
    background-color: #4CAF50;
    color: white;
}
.modal-button.no {
    background-color: #f44336;
    color: white;
}
.modal-button:hover {
    opacity: 0.8;
}
</style>
<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@400;700&display=swap" rel="stylesheet">
</head>
<body>
<button class="menu-toggle" onclick="toggleMenu()">‚ò∞ –ú–µ–Ω—é</button>
<div class="menu" id="menu">
    <h2>–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h2>
    <div class="menu-item" onclick="activateAutoClicker()">üñ±Ô∏è –ê–≤—Ç–æ-–ö–ª–∏–∫–µ—Ä (–°—Ç–æ–∏–º–æ—Å—Ç—å: 1000 üå±)</div>
    <div class="menu-item" onclick="activateGoldenSeeds()">üåü –ó–æ–ª–æ—Ç—ã–µ –°–µ–º–µ–Ω–∞ (–°—Ç–æ–∏–º–æ—Å—Ç—å: 2000 üå±)</div>
    <div class="menu-item" onclick="activateRainDance()">üíÉ –¢–∞–Ω–µ—Ü –î–æ–∂–¥—è (–°—Ç–æ–∏–º–æ—Å—Ç—å: 3000 üå±)</div>
    <div class="menu-item" onclick="activateFairyDust()">‚ú® –ü—ã–ª—å—Ü–∞ –§–µ–π (–°—Ç–æ–∏–º–æ—Å—Ç—å: 5000 üå±)</div>
    <div class="menu-item" onclick="activateTimeWarp()">‚è≥ –ò—Å–∫—Ä–∏–≤–ª–µ–Ω–∏–µ –í—Ä–µ–º–µ–Ω–∏ (–°—Ç–æ–∏–º–æ—Å—Ç—å: 10000 üå±)</div>
    <div class="menu-item" onclick="goToGreenhouse()">üè° –ü–µ—Ä–µ–π—Ç–∏ –≤ –¢–µ–ø–ª–∏—Ü—É</div>
    <div class="menu-item" onclick="showRebirthModal()">üîÑ –ü–µ—Ä–µ—Ä–æ–∂–¥–µ–Ω–∏–µ</div>
</div>
<div class="game-container">
    <h1>–≠–∫–æ-–°–∞–¥ –ö–ª–∏–∫–µ—Ä</h1>
    <p>–†–∞—Å—Ç–µ–Ω–∏—è: <span id="plantCount">0</span> üå±</p>
    <p>–†–∞—Å—Ç–µ–Ω–∏–π –≤ —Å–µ–∫—É–Ω–¥—É: <span id="pps">0</span> üå±</p>
    <p id="passive-income">–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥: <span id="passiveIncomeValue">0</span> üå±/—Å–µ–∫</p>
    <svg id="garden" viewBox="0 0 100 100" onclick="clickGarden()">
        <rect x="0" y="70" width="100" height="30" fill="#8B4513"/>
        <circle cx="50" cy="50" r="30" fill="#228B22"/>
        <circle cx="50" cy="50" r="25" fill="#32CD32"/>
        <circle cx="50" cy="50" r="20" fill="#7CFC00"/>
        <circle cx="40" cy="40" r="5" fill="#FFD700"/>
        <circle cx="60" cy="40" r="5" fill="#FFD700"/>
        <circle cx="50" cy="60" r="5" fill="#FFD700"/>
    </svg>
    <div id="message-display"></div>
    <div id="upgrades"></div>
    <div class="special-actions">
        <div class="special-action" onclick="activateSunshine()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –°–æ–ª–Ω–µ—á–Ω—ã–π –°–≤–µ—Ç</div>
        <div class="special-action" onclick="callPollinators()">–ü—Ä–∏–∑–≤–∞—Ç—å –û–ø—ã–ª–∏—Ç–µ–ª–µ–π</div>
    </div>
</div>
<canvas id="particles"></canvas>
<div id="weather-event"></div>
<button class="help-button" onclick="showHelp()">–ü–æ–º–æ—â—å</button>

<div id="helpModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeHelp()">&times;</span>
        <h2>–°–ø—Ä–∞–≤–∫–∞ –ø–æ —É–ª—É—á—à–µ–Ω–∏—è–º</h2>
        <div id="helpContent"></div>
    </div>
</div>

<div id="rebirthModal" class="modal">
    <div class="modal-content">
        <span class="close" onclick="closeRebirthModal()">&times;</span>
        <h2>–í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ</h2>
        <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–æ–≤–µ—Ä—à–∏—Ç—å –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ?</p>
        <p>–°—Ç–æ–∏–º–æ—Å—Ç—å –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è: <span id="rebirthCost">10000000</span> üå±</p>
        <p>–≠—Ç–æ –¥–∞—Å—Ç –≤–∞–º –º–Ω–æ–∂–∏—Ç–µ–ª—å x1.5 –∫–æ –≤—Å–µ–º—É –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤—É.</p>
        <div class="modal-buttons">
            <button class="modal-button yes" onclick="performRebirth()">–î–∞</button>
            <button class="modal-button no" onclick="closeRebirthModal()">–ù–µ—Ç</button>
        </div>
    </div>
</div>

<script>
let plants = 0;
let pps = 0;
let passiveIncome = 0;
let rebirthMultiplier = 1;
let rebirthCost = 10000000;
let rebirthCount = 0;
const upgrades = [
    { name: "–ó–µ–ª—ë–Ω—ã–π –ü–∞–ª–µ—Ü", baseCost: 10, costMultiplier: 1.15, baseEffect: 1, effect: 1, count: 0, description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞—Å—Ç–µ–Ω–∏–π –∑–∞ –∫–ª–∏–∫" },
    { name: "–õ–µ–π–∫–∞", baseCost: 50, costMultiplier: 1.2, baseEffect: 5, effect: 5, count: 0, description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—Ä–∞—â–∏–≤–∞–µ—Ç —Ä–∞—Å—Ç–µ–Ω–∏—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É" },
    { name: "–£–¥–æ–±—Ä–µ–Ω–∏–µ", baseCost: 200, costMultiplier: 1.25, baseEffect: 20, effect: 20, count: 0, description: "–ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç —Ä–æ—Å—Ç —Ä–∞—Å—Ç–µ–Ω–∏–π" },
    { name: "–¢–µ–ø–ª–∏—Ü–∞", baseCost: 1000, costMultiplier: 1.3, baseEffect: 100, effect: 100, count: 0, description: "–°–æ–∑–¥–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è —Ä–∞—Å—Ç–µ–Ω–∏–π" },
    { name: "–ë–æ—Ç–∞–Ω–∏—á–µ—Å–∫–∏–µ –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", baseCost: 5000, costMultiplier: 1.35, baseEffect: 500, effect: 500, count: 0, description: "–û—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–æ–≤—ã–µ –≤–∏–¥—ã —Ä–∞—Å—Ç–µ–Ω–∏–π –∏ –º–µ—Ç–æ–¥—ã –∏—Ö –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è" }
];

let sunshineActive = false;
let pollinatorsActive = false;
let autoClickerActive = false;
let goldenSeedsActive = false;
let rainDanceActive = false;
let fairyDustActive = false;
let timeWarpActive = false;

let lastClickTime = 0;
const clickDelay = 500; // 0.5 seconds in milliseconds

// Load saved game data
function loadGame() {
    const savedGame = localStorage.getItem('ecoGardenSave');
    if (savedGame) {
        const gameData = JSON.parse(savedGame);
        plants = gameData.plants;
        pps = gameData.pps;
        passiveIncome = gameData.passiveIncome || 0;
        rebirthMultiplier = gameData.rebirthMultiplier || 1;
        rebirthCost = gameData.rebirthCost || 1000000;
        rebirthCount = gameData.rebirthCount || 0;
        upgrades.forEach((upgrade, index) => {
            upgrade.count = gameData.upgrades[index].count;
            upgrade.effect = gameData.upgrades[index].effect;
        });
        autoClickerActive = gameData.autoClickerActive;
        updatePlants();
        updateUpgrades();
        updatePassiveIncome();
    }
}

// Save game data
function saveGame() {
    const gameData = {
        plants: plants,
        pps: pps,
        passiveIncome: passiveIncome,
        rebirthMultiplier: rebirthMultiplier,
        rebirthCost: rebirthCost,
        rebirthCount: rebirthCount,
        upgrades: upgrades.map(upgrade => ({count: upgrade.count, effect: upgrade.effect})),
        autoClickerActive: autoClickerActive
    };
    localStorage.setItem('ecoGardenSave', JSON.stringify(gameData));
}

function toggleMenu() {
    document.getElementById('menu').classList.toggle('open');
}

function updatePlants() {
    document.getElementById('plantCount').textContent = Math.floor(plants);
    document.getElementById('pps').textContent = pps.toFixed(1);
}

function updatePassiveIncome() {
    document.getElementById('passiveIncomeValue').textContent = passiveIncome.toFixed(1);
}

function clickGarden() {
    const currentTime = new Date().getTime();
    if (currentTime - lastClickTime < clickDelay) {
        return; // Ignore clicks that are too close together
    }
    lastClickTime = currentTime;

    let baseClick = (1 + upgrades[0].effect * upgrades[0].count) * rebirthMultiplier;
    if (sunshineActive) baseClick *= 2;
    if (pollinatorsActive) baseClick *= 3;
    if (goldenSeedsActive) baseClick *= 2;
    if (fairyDustActive) baseClick *= 5;
    plants += baseClick;
    updatePlants();
    document.getElementById('garden').classList.add('grow');
    setTimeout(() => document.getElementById('garden').classList.remove('grow'), 500);
    createLeaf();
    showRandomMessage();
    saveGame();
}

function buyUpgrade(index) {
    const upgrade = upgrades[index];
    const cost = Math.floor(upgrade.baseCost * Math.pow(upgrade.costMultiplier, upgrade.count));
    if (plants >= cost && upgrade.count < 100) {
        plants -= cost;
        upgrade.count++;
        upgrade.effect = upgrade.baseEffect * Math.pow(1.05, upgrade.count) * rebirthMultiplier;
        updateUpgrades();
        updatePlants();
        pps = calculatePPS();
        updatePassiveIncome();
        saveGame();
    }
}

function calculatePPS() {
    let basePPS = upgrades.reduce((sum, upgrade) => sum + upgrade.effect * upgrade.count, 0);
    basePPS *= rebirthMultiplier;
    if (rainDanceActive) basePPS *= 2;
    if (timeWarpActive) basePPS *= 3;
    return basePPS;
}

function updateUpgrades() {
    const upgradesContainer = document.getElementById('upgrades');
    upgradesContainer.innerHTML = '';
    upgrades.forEach((upgrade, index) => {
        const cost = Math.floor(upgrade.baseCost * Math.pow(upgrade.costMultiplier, upgrade.count));
        const button = document.createElement('div');
        button.className = 'upgrade';
        button.textContent = `${upgrade.name} (${upgrade.count}/100) - –°—Ç–æ–∏–º–æ—Å—Ç—å: ${cost} üå±`;
        button.onclick = () => buyUpgrade(index);
        upgradesContainer.appendChild(button);
    });
}

function createLeaf() {
    const leaf = document.createElement('div');
    leaf.style.position = 'absolute';
    leaf.style.width = '20px';
    leaf.style.height = '20px';
    leaf.style.backgroundColor = `hsl(${Math.random() * 60 + 90}, 100%, 40%)`;
    leaf.style.clipPath = 'polygon(50% 0%, 0% 100%, 100% 100%)';
    leaf.style.pointerEvents = 'none';
    const gardenRect = document.getElementById('garden').getBoundingClientRect();
    const startX = gardenRect.left + gardenRect.width / 2;
    const startY = gardenRect.top + gardenRect.height / 2;
    leaf.style.left = startX + 'px';
    leaf.style.top = startY + 'px';
    document.body.appendChild(leaf);

    const angle = Math.random() * Math.PI * 2;
    const velocity = 2 + Math.random() * 3;
    const rotationSpeed = Math.random() * 360 - 180;
    const lifetime = 2000 + Math.random() * 1000;
    let opacity = 1;

    const animate = (timestamp) => {
        const progress = timestamp - startTime;
        if (progress < lifetime) {
            const x = startX + Math.cos(angle) * velocity * progress / 50;
            const y = startY + Math.sin(angle) * velocity * progress / 50 + 0.5 * progress * progress / 5000;
            opacity = 1 - progress / lifetime;
            leaf.style.left = x + 'px';
            leaf.style.top = y + 'px';
            leaf.style.opacity = opacity;
            leaf.style.transform = `rotate(${rotationSpeed * progress / 1000}deg)`;
            requestAnimationFrame(animate);
        } else {
            leaf.remove();
        }
    };

    const startTime = performance.now();
    requestAnimationFrame(animate);
}

function gameLoop() {
    plants += pps / 10;
    plants += passiveIncome / 10;
    if (autoClickerActive) {
        plants += upgrades[0].effect * upgrades[0].count / 10;
    }
    updatePlants();
    saveGame();
}

function showRandomMessage() {
    const messages = [
        "–í–∞—à —Å–∞–¥ –ø—Ä–æ—Ü–≤–µ—Ç–∞–µ—Ç!",
        "–†–∞—Å—Ç–µ–Ω–∏—è —Ä–∞—Å—Ç—É—Ç –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ!",
        "–ì–∞—Ä–º–æ–Ω–∏—è –ø—Ä–∏—Ä–æ–¥—ã –æ–∫—Ä—É–∂–∞–µ—Ç –≤–∞—Å!",
        "–£ –≤–∞—Å –∑–µ–ª—ë–Ω–∞—è —Ä—É–∫–∞!",
        "–≠–∫–æ—Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ—Ü–≤–µ—Ç–∞–µ—Ç!"
    ];
    const randomMessage = messages[Math.floor(Math.random() * messages.length)];
    document.getElementById('message-display').textContent = randomMessage;
    setTimeout(() => document.getElementById('message-display').textContent = '', 3000);
}

function activateSunshine() {
    if (plants >= 1000 && !sunshineActive) {
        plants -= 1000;
        sunshineActive = true;
        document.body.style.background = 'linear-gradient(135deg, #ffd700, #ff8c00)';
        setTimeout(() => {
            sunshineActive = false;
            document.body.style.background = 'linear-gradient(135deg, #7cbb5e, #2e8b57)';
        }, 30000);
        saveGame();
    }
}

function callPollinators() {
    if (plants >= 5000 && !pollinatorsActive) {
        plants -= 5000;
        pollinatorsActive = true;
        const weatherEvent = document.getElementById('weather-event');
        weatherEvent.textContent = "–û–ø—ã–ª–∏—Ç–µ–ª–∏ —Ä–æ—è—Ç—Å—è –≤ –≤–∞—à–µ–º —Å–∞–¥—É!";
        weatherEvent.style.display = 'block';
        setTimeout(() => {
            pollinatorsActive = false;
            weatherEvent.style.display = 'none';
        }, 60000);
        saveGame();
    }
}

function activateAutoClicker() {
    if (plants >= 1000 && !autoClickerActive) {
        plants -= 1000;
        autoClickerActive = true;
        showMessage("–ê–≤—Ç–æ-–ö–ª–∏–∫–µ—Ä –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!");
        saveGame();
    }
}

function activateGoldenSeeds() {
    if (plants >= 2000 && !goldenSeedsActive) {
        plants -= 2000;
        goldenSeedsActive = true;
        showMessage("–ó–æ–ª–æ—Ç—ã–µ –°–µ–º–µ–Ω–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã!");
        setTimeout(() => {
            goldenSeedsActive = false;
            showMessage("–î–µ–π—Å—Ç–≤–∏–µ –ó–æ–ª–æ—Ç—ã—Ö –°–µ–º—è–Ω –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å.");
        }, 120000);
        saveGame();
    }
}

function activateRainDance() {
    if (plants >= 3000 && !rainDanceActive) {
        plants -= 3000;
        rainDanceActive = true;
        showMessage("–¢–∞–Ω–µ—Ü –î–æ–∂–¥—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!");
        document.body.style.background = 'linear-gradient(135deg, #4a69bd, #0c2461)';
        setTimeout(() => {
            rainDanceActive = false;
            document.body.style.background = 'linear-gradient(135deg, #7cbb5e, #2e8b57)';
            showMessage("–î–æ–∂–¥—å –ø—Ä–µ–∫—Ä–∞—Ç–∏–ª—Å—è.");
        }, 180000);
        saveGame();
    }
}

function activateFairyDust() {
    if (plants >= 5000 && !fairyDustActive) {
        plants -= 5000;
        fairyDustActive = true;
        showMessage("–ü—ã–ª—å—Ü–∞ –§–µ–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞!");
        document.getElementById('garden').classList.add('pulse');
        setTimeout(() => {
            fairyDustActive = false;
            document.getElementById('garden').classList.remove('pulse');
            showMessage("–î–µ–π—Å—Ç–≤–∏–µ –ü—ã–ª—å—Ü—ã –§–µ–π –∑–∞–∫–æ–Ω—á–∏–ª–æ—Å—å.");
        }, 300000);
        saveGame();
    }
}

function activateTimeWarp() {
    if (plants >= 10000 && !timeWarpActive) {
        plants -= 10000;
        timeWarpActive = true;
        showMessage("–ò—Å–∫—Ä–∏–≤–ª–µ–Ω–∏–µ –í—Ä–µ–º–µ–Ω–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!");
        document.body.style.transition = 'all 0.5s';
        document.body.style.filter = 'hue-rotate(180deg)';
        setTimeout(() => {
            timeWarpActive = false;
            document.body.style.filter = 'none';
            showMessage("–í—Ä–µ–º—è –≤–µ—Ä–Ω—É–ª–æ—Å—å –≤ –Ω–æ—Ä–º—É.");
        }, 600000);
        saveGame();
    }
}

function showMessage(message) {
    const weatherEvent = document.getElementById('weather-event');
    weatherEvent.textContent = message;
    weatherEvent.style.display = 'block';
    setTimeout(() => {
        weatherEvent.style.display = 'none';
    }, 5000);
}

function showHelp() {
    const modal = document.getElementById('helpModal');
    const helpContent = document.getElementById('helpContent');
    helpContent.innerHTML = '';

    upgrades.forEach(upgrade => {
        const upgradeInfo = document.createElement('p');
        upgradeInfo.innerHTML = `<strong>${upgrade.name}:</strong> ${upgrade.description}`;
        helpContent.appendChild(upgradeInfo);
    });

    const specialActions = [
        { name: "–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –°–æ–ª–Ω–µ—á–Ω—ã–π –°–≤–µ—Ç", description: "–£–¥–≤–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ 30 —Å–µ–∫—É–Ω–¥" },
        { name: "–ü—Ä–∏–∑–≤–∞—Ç—å –û–ø—ã–ª–∏—Ç–µ–ª–µ–π", description: "–£—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ 60 —Å–µ–∫—É–Ω–¥" },
        { name: "–ê–≤—Ç–æ-–ö–ª–∏–∫–µ—Ä", description: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–∏–∫–∞–µ—Ç –ø–æ —Å–∞–¥—É –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É" },
        { name: "–ó–æ–ª–æ—Ç—ã–µ –°–µ–º–µ–Ω–∞", description: "–£–¥–≤–∞–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –æ—Ç –∫–ª–∏–∫–æ–≤ –Ω–∞ 2 –º–∏–Ω—É—Ç—ã" },
        { name: "–¢–∞–Ω–µ—Ü –î–æ–∂–¥—è", description: "–£–¥–≤–∞–∏–≤–∞–µ—Ç –ø–∞—Å—Å–∏–≤–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ 3 –º–∏–Ω—É—Ç—ã" },
        { name: "–ü—ã–ª—å—Ü–∞ –§–µ–π", description: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –æ—Ç –∫–ª–∏–∫–æ–≤ –≤ 5 —Ä–∞–∑ –Ω–∞ 5 –º–∏–Ω—É—Ç" },
        { name: "–ò—Å–∫—Ä–∏–≤–ª–µ–Ω–∏–µ –í—Ä–µ–º–µ–Ω–∏", description: "–£—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Å–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ —Ä–∞—Å—Ç–µ–Ω–∏–π –Ω–∞ 10 –º–∏–Ω—É—Ç" }
    ];

    helpContent.appendChild(document.createElement('hr'));

    specialActions.forEach(action => {
        const actionInfo = document.createElement('p');
        actionInfo.innerHTML = `<strong>${action.name}:</strong> ${action.description}`;
        helpContent.appendChild(actionInfo);
    });

    modal.style.display = 'block';
}

function closeHelp() {
    document.getElementById('helpModal').style.display = 'none';
}

function showRebirthModal() {
    document.getElementById('rebirthCost').textContent = rebirthCost.toLocaleString();
    document.getElementById('rebirthModal').style.display = 'block';
}

function closeRebirthModal() {
    document.getElementById('rebirthModal').style.display = 'none';
}

function performRebirth() {
    if (plants >= rebirthCost) {
        plants = 0;
        rebirthCount++;
        rebirthMultiplier *= 1.5;
        rebirthCost *= 4;
        upgrades.forEach(upgrade => {
            upgrade.count = 0;
            upgrade.effect = upgrade.baseEffect;
        });
        pps = 0;
        passiveIncome = 0;
        autoClickerActive = false;
        showMessage(`–í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ! –ù–æ–≤—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å: x${rebirthMultiplier.toFixed(2)}`);
        updatePlants();
        updateUpgrades();
        updatePassiveIncome();
        saveGame();
        closeRebirthModal();
    } else {
        showMessage("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ä–∞—Å—Ç–µ–Ω–∏–π –¥–ª—è –≤–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è!");
    }
}

function goToGreenhouse() {
    saveGame();
    window.location.href = 'greenhouse.html';
}

window.onclick = function(event) {
    const helpModal = document.getElementById('helpModal');
    const rebirthModal = document.getElementById('rebirthModal');
    if (event.target == helpModal) {
        helpModal.style.display = "none";
    }
    if (event.target == rebirthModal) {
        rebirthModal.style.display = "none";
    }
}

loadGame();
updateUpgrades();
setInterval(gameLoop, 100);

// Particle background
const canvas = document.getElementById('particles');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

const particlesArray = [];

class Particle {
    constructor() {
        this.x = Math.random() * canvas.width;
        this.y = Math.random() * canvas.height;
        this.size = Math.random() * 5 + 1;
        this.speedX = Math.random() * 3 - 1.5;
        this.speedY = Math.random() * 3 - 1.5;
        this.color = `hsl(${Math.random() * 60 + 90}, 100%, 50%)`;
    }
    update() {
        this.x += this.speedX;
        this.y += this.speedY;
        if (this.size > 0.2) this.size -= 0.1;
    }
    draw() {
        ctx.fillStyle = this.color;
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
        ctx.fill();
    }
}

function handleParticles() {
    for (let i = 0; i < particlesArray.length; i++) {
        particlesArray[i].update();
        particlesArray[i].draw();
        if (particlesArray[i].size <= 0.2) {
            particlesArray.splice(i, 1);
            i--;
        }
    }
}

function createParticles() {
    if (particlesArray.length < 100) {
        particlesArray.push(new Particle());
    }
}

function animateParticles() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    handleParticles();
    createParticles();
    requestAnimationFrame(animateParticles);
}

animateParticles();

window.addEventListener('resize', function() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
});
</script>
</body></html>
